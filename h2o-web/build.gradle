import org.apache.tools.ant.taskdefs.condition.Os

apply plugin: 'java'

description = "H2O web client"

def getOsSpecificCommandLine(command, arg) {
  if (Os.isFamily(Os.FAMILY_WINDOWS)) {
    return [ 'cmd', '/c', command, arg ]
  } else {
    return [ command, arg ]
  }
}

task installNpmPackages(type: Exec) {
  commandLine = getOsSpecificCommandLine( 'npm', 'install' )
}

task installBowerPackages(type: Exec) {
  commandLine = getOsSpecificCommandLine( 'bower', 'install' )
}

task buildClientWithGulp(type: Exec) {
  commandLine = getOsSpecificCommandLine( 'gulp', '' )
}

task cleanClientWithGulp(type: Exec) {
  commandLine = getOsSpecificCommandLine( 'gulp', 'clean' )
}

installBowerPackages.dependsOn installNpmPackages
buildClientWithGulp.dependsOn installBowerPackages
processResources.dependsOn buildClientWithGulp
clean.dependsOn cleanClientWithGulp
